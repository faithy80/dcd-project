{% extends 'base.html' %}

{% block content %}

<!-- view section -->
<section class="container-fluid view-container">
    <div class="row">
        <div class="col-12">

            {% if errors %}
            <div class="alert alert-danger">
                <ul>
                    {% for error in errors %}
                    <li>{{error}}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            {% if recipe %}
            <img src="{{recipe.img_link}}" alt="Recipe image" />
            <h2>{{recipe.title}}</h2>

            <p>Category: {{recipe.category}}</p>

            <p>Servings: {{recipe.servings}}</p>

            <p>Ingredients:</p>
            <ul>
                {% for ingredient in recipe.ingredients %}
                <li>{{ingredient}}</li>
                {% endfor %}
            </ul>

            <p>Method:</p>
            <ul>
                {% for step in recipe.method %}
                <li>{{step}}</li>
                {% endfor %}
            </ul>

            <p>Appliances used for the recipe:</p>
            <ul>
                {% for category in recipe.appliances %}
                <li>
                    <a class="btn btn-link" href="{{ url_for('search', collection='appliances', find=category) }}"
                        target="_blank">{{category}}</a>
                </li>
                {% endfor %}
            </ul>


            <p>Reviews:</p>
            <ul>
                {% for review in recipe.reviews %}
                <li>{{review}}</li>
                {% endfor %}
            </ul>

            <p>Viewed: {{recipe.view_stat}} times</p>

            {% if form %}
            <form action="{{ url_for('add_review', db_id=recipe._id, collection='recipe') }}" method="POST">
                <div class="form-group">
                    <label for="review">Add review</label>
                    <textarea class="form-control" id="review" name="review" rows="3" maxlength="250"
                        required>{{form.review}}</textarea>
                </div>

                <div id="review-counter" class="float-right"></div>

                <button type="submit" name="action" class="btn btn-primary btn--orange btn-inline">Submit
                    review</button>
                <a type="button" href="{{request.referrer}}" class="btn btn-primary btn--orange btn-inline">Go back</a>
            </form>

            {% else %}

            <form action="{{ url_for('add_review', db_id=recipe._id, collection='recipe') }}" method="POST">
                <div class="form-group">
                    <label for="review">Add review</label>
                    <textarea class="form-control" id="review" name="review" rows="3" maxlength="250"
                        required></textarea>
                </div>

                <div id="review-counter" class="float-right"></div>

                <button type="submit" name="action" class="btn btn-primary btn--orange btn-inline">Submit
                    review</button>
                <a type="button" href="{{request.referrer}}" class="btn btn-primary btn--orange btn-inline">Go back</a>
            </form>
            {% endif %}

            {% elif appliance %}
            <img src="{{appliance.img_link}}" alt="Appliance image" />

            <h2>{{appliance.brand}} {{appliance.model}}</h2>

            <p>Category: {{appliance.type}}</p>

            <p>Fuel type: {{appliance.fuel_type}}</p>

            <p>Colour: {{appliance.colour}}</p>

            <p>Description: {{appliance.description}}</p>

            <p>Price: {{appliance.price}} euro</p>

            <p>Reviews:</p>
            <ul>
                {% for review in appliance.reviews %}
                <li>{{review}}</li>
                {% endfor %}
            </ul>

            <p>Viewed: {{appliance.view_stat}} times</p>

            {% if form %}
            <form action="{{ url_for('add_review', db_id=appliance._id, collection='appliance') }}" method="POST">
                <div class="form-group">
                    <label for="review">Add review</label>
                    <textarea class="form-control" id="review" name="review" rows="3" maxlength="250"
                        required>{{form.review}}</textarea>
                </div>

                <div id="review-counter" class="float-right"></div>

                <button type="submit" name="action" class="btn btn-primary btn--orange btn-inline">Submit
                    review</button>
                <a type="button" href="{{request.referrer}}" class="btn btn-primary btn--orange btn-inline">Go back</a>
            </form>
            {% else %}

            {% endif %}

            <form action="{{ url_for('add_review', db_id=appliance._id, collection='appliance') }}" method="POST">
                <div class="form-group">
                    <label for="review">Add review</label>
                    <textarea class="form-control" id="review" name="review" rows="3" maxlength="250"
                        required></textarea>
                </div>

                <div id="review-counter" class="float-right"></div>

                <button type="submit" name="action" class="btn btn-primary btn--orange btn-inline">Submit
                    review</button>
                <a type="button" href="{{request.referrer}}" class="btn btn-primary btn--orange btn-inline">Go back</a>
            </form>
            {% endif %}

        </div>
    </div>
</section>

<script src="{{ url_for('static', filename='js/review.js') }}" defer></script>

{% endblock %}